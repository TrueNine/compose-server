---
description: Kotlin é¡¹ç›®è§„èŒƒä¸æœ€ä½³å®è·µæŒ‡å—
globs: *.kt
alwaysApply: false
---

- Kotlin 2.1+
- JDK 24+

# ğŸ”„ Kotlin ä¸ Java äº’æ“ä½œè§„èŒƒ

## ç±»è®¾è®¡åŸåˆ™
```kotlin
// âœ… æ¨èï¼šæ˜¾å¼å£°æ˜ open ä»¥æ”¯æŒç»§æ‰¿
open class BaseService

// âœ… æ¨èï¼šä½¿ç”¨ @JvmField æš´éœ²å…¬å…±å­—æ®µ
@JvmField
val MAX_COUNT = 100

// âœ… æ¨èï¼šä¸ºå±æ€§ç”Ÿæˆ Java é£æ ¼è®¿é—®å™¨
@get:JvmName("getValue")
@set:JvmName("setValue")
var value: String = ""
```

## ç©ºå®‰å…¨å¤„ç†
```kotlin
// âœ… æ¨èï¼šæ˜ç¡®çš„å¯ç©ºæ€§å£°æ˜
class UserDto {
  // Java è°ƒç”¨æ—¶è‡ªåŠ¨å¤„ç†å¯ç©ºæ€§
  @get:JvmName("getName")
  val name: String? = null

  // ç¡®ä¿ Java ä»£ç å¿…é¡»å¤„ç†ç©ºå€¼
  @NotNull
  lateinit var email: String
}
```

## å‡½æ•°è®¾è®¡
```kotlin
// âœ… æ¨èï¼šä¸ºé»˜è®¤å‚æ•°æä¾› Java é‡è½½
@JvmOverloads
fun process(data: String, retry: Int = 3)

// âœ… æ¨èï¼šæ‰©å±•å‡½æ•°ä½¿ç”¨ä¼´ç”Ÿå¯¹è±¡
class StringUtils {
  companion object {
    @JvmStatic
    fun String.encrypt(): String = // å®ç°
  }
}
```

## åç¨‹æ”¯æŒ
```kotlin
// âœ… æ¨èï¼šæä¾›é˜»å¡å¼ Java è°ƒç”¨æ–¹æ³•
@JvmName("fetchUserBlocking")
fun fetchUser() = runBlocking {
  // åç¨‹å®ç°
}

// âœ… æ¨èï¼šæš´éœ² suspend å‡½æ•°çš„ Java é€‚é…å™¨
@JvmName("fetchUserAsync")
fun fetchUserAsync() = GlobalScope.future {
  // åç¨‹å®ç°
}
```

# ğŸ¯ å‡½æ•°å¼ API æœ€ä½³å®è·µ

## é›†åˆæ“ä½œ
```kotlin
// âœ… æ¨èï¼šä½¿ç”¨å‡½æ•°å¼é“¾å¼è°ƒç”¨
users.asSequence()
  .filter { it.age > 18 }
  .map { it.toDto() }
  .toList()

// âŒ ç¦æ­¢ï¼šä½¿ç”¨å¤šä¸ªä¸­é—´é›†åˆ
val adults = users.filter { it.age > 18 }
val dtos = adults.map { it.toDto() }
```

## ä½œç”¨åŸŸå‡½æ•°
```kotlin
// âœ… æ¨èï¼šä½¿ç”¨ let å¤„ç†å¯ç©ºå€¼
user?.let {
  processUser(it)
}

// âœ… æ¨èï¼šä½¿ç”¨ apply é…ç½®å¯¹è±¡
UserEntity().apply {
  name = "Alice"
  age = 20
  email = "alice@example.com"
}

// âœ… æ¨èï¼šä½¿ç”¨ run æ‰§è¡Œä»£ç å—å¹¶è¿”å›ç»“æœ
val result = user.run {
  validate()
  process()
  toDto()
}

// âœ… æ¨èï¼šä½¿ç”¨ also æ‰§è¡Œå‰¯ä½œç”¨
user.also {
  logger.info("Processing user: ${it.id}")
}
```

## é«˜é˜¶å‡½æ•°
```kotlin
// âœ… æ¨èï¼šä½¿ç”¨ TypeAlias ç®€åŒ–å‡½æ•°ç±»å‹
typealias Operation<T> = (T) -> Unit
typealias Transformer<T, R> = (T) -> R

// âœ… æ¨èï¼šä½¿ç”¨é«˜é˜¶å‡½æ•°å¢å¼ºå¯å¤ç”¨æ€§
fun <T> withTransaction(block: () -> T): T {
  return try {
    beginTransaction()
    val result = block()
    commit()
    result
  } catch (e: Exception) {
    rollback()
    throw e
  }
}

// âœ… æ¨èï¼šä½¿ç”¨ inline ä¼˜åŒ–æ€§èƒ½
inline fun <T> measureTimeMillis(block: () -> T): Pair<T, Long> {
  val start = System.currentTimeMillis()
  val result = block()
  val end = System.currentTimeMillis()
  return result to (end - start)
}
```

## æ‰©å±•å‡½æ•°
```kotlin
// âœ… æ¨èï¼šä½¿ç”¨æ‰©å±•å‡½æ•°å¢å¼ºç°æœ‰ç±»
fun List<UserEntity>.toUserDtos(): List<UserDto> =
  map { it.toDto() }

// âœ… æ¨èï¼šä½¿ç”¨æ‰©å±•å±æ€§ç®€åŒ–è®¿é—®
val UserEntity.fullName: String
  get() = "$firstName $lastName"
```

## å¼‚å¸¸å¤„ç†
```kotlin
// âœ… æ¨èï¼šä½¿ç”¨ Kotlin å†…ç½®æ£€æŸ¥å‡½æ•°
require(age > 0) { "å¹´é¾„å¿…é¡»å¤§äº 0" }
check(email.contains("@")) { "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®" }
error("æœªçŸ¥é”™è¯¯")

// âŒ ç¦æ­¢ï¼šç›´æ¥æŠ›å‡ºå¼‚å¸¸
throw IllegalArgumentException("xxx")
```

# ğŸ“ æ–‡æ¡£è§„èŒƒ

## ç±»æ–‡æ¡£æ¨¡æ¿
```kotlin
/**
 * # åŠŸèƒ½åç§°
 *
 * è¯¦ç»†è¯´æ˜
 * @param paramName å‚æ•°è¯´æ˜
 */
```

## æ–¹æ³•æ–‡æ¡£æ¨¡æ¿
```kotlin
/**
 * ## æ–¹æ³•åç§°
 * @param paramName å‚æ•°è¯´æ˜
 * @return è¿”å›å€¼è¯´æ˜
 */
```