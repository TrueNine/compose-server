# claude code 核心工作规则

## 沟通效率优化
- 批量处理相关任务以减少交互轮次
- 将多个相关修改合并为单次操作

# 通用代码标准

## 编程原则
- 函数参数限制在5个以内
- 禁止硬编码常量，使用配置或常量定义
- 避免静默失败

## 代码风格一致性
- 强制使用大括号包围代码块，即使只有一行代码（防止类似苹果 goto fail 的安全漏洞）

## 注释标准
- API 文档注释使用英文
- 注释解释"为什么"而非"是什么"

## 安全编程指南
- 严格禁止在代码中暴露敏感信息（密钥、密码等）
- 使用参数化查询防止注入攻击

# 语言特定标准

## SQL
- 必须使用参数化查询，严格禁止字符串拼接
- 使用 snake_case 命名约定

## Markdown
- 代码块必须指定语言类型
- 避免标题层级跳跃

## Java/Kotlin
- 强制使用大括号包围所有代码块
- 优先使用 final（Java）或 val（Kotlin）
- Kotlin 中使用空安全操作符，避免 !! 操作符

## Rust 标准
- 避免使用 unwrap()，使用 expect() 或模式匹配
- 优先使用迭代器而非索引循环

## TypeScript 标准
- 启用严格模式（strict: true）
- 避免使用 any 类型，使用 unknown 或具体类型
- 函数参数和返回值必须有类型注解

## Vue 标准
- 使用 Composition API 和 <script setup>
- Props 定义必须包含类型和默认值
- 模板中避免复杂表达式，使用计算属性

## Kotlin Script (.kts)
- 脚本顶层避免复杂逻辑，使用函数封装

# 开发方法论

## TDD (测试驱动开发)
- 先写失败测试，再写实现代码，最后重构
- 测试用例必须覆盖边界条件和异常情况
- 单元测试应独立运行，不依赖外部资源
- 测试命名应清晰表达测试意图和预期结果
- 避免测试实现细节，专注测试行为和契约

## DDD + CQRS + EDA
- 使用统一语言（Ubiquitous Language）进行建模
- 聚合根维护业务不变性，通过事件发布状态变更
- 命令和查询严格分离（CQRS）
- 领域事件驱动业务流程，实现聚合间解耦
- 事件溯源记录状态变更历史

# 质量保证

## 技术选型原则
- 避免过度工程和不必要的复杂性
- 禁止私自引入新的第三方库，必须经过团队评审
