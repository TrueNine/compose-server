# 通用规范

**输出要求**

- 总是以简体中文输出

**强制要求**

- 严禁将问题简单化以解决问题
- 严禁降级依赖版本来解决问题
- 出现在上下文当中的代码，应当积极按照规则来重构修复
- 严禁代码中暴露API密钥、密码、token
- 应当积极使用日志api来完成日志记录，缺失日志记录时需积极补充
- 单元测试调试时，可积极添加日志以协助问题解决
- 必须尽可能多地使用 `elary return` 技巧以减少代码层级嵌套

**注释规范**

- API文档：英文注释
- 代码注释：解释"为什么"而非"做什么"

**测试约定**

1. TDD流程：失败测试→实现代码→重构
2. 覆盖边界条件和异常情况
3. 独立运行，无外部依赖
4. 测试命名清晰表达意图
5. 测试类与被测试类同名
6. **嵌套测试组织**：使用@Nested内部类按功能分组，避免根级别大量独立测试方法

- 每个被测试类/函数/变量/方法创建主要分组
- 按场景细分：正常用例、异常用例、边界用例
- 示例kotlin：`@Nested inner class CreateUser { @Test fun should_create_successfully() {} }`

**架构约定**

- DDD：统一语言建模，聚合根维护不变性
- CQRS：命令查询分离
- EDA：事件驱动解耦

# 特定语言约定

**SQL标准**

1. 检查现有查询是否使用参数化
2. 统一使用snake_case命名
3. 验证无字符串拼接风险

**jvm语言标准**

1. 严谨在测试代码中使用 `@DisplayName` 注解
2. spring/quarkus 中严谨使用特定框架的注解，例如：`@Autowired`必须使用 `@Resource` 替代

**Java标准**

1. 尽可能使用jdk的新特性
2. 声明变量应尽量使用 `final var`
3. 积极使用 lambda
4. 严禁使用 `System.out.println` 记录输出

**Kotlin标准**

1. 优先使用val声明不可变变量
2. 避免!!操作符，使用?.或let{}
3. 数据类替代多参数函数
4. 严禁使用 `println` 记录输出

**前端代码标准**

- TypeScript: 启用strict模式，避免any类型
- Vue: 积极使用 vue3 新特性
